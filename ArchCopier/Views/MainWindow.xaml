<Window x:Class="ArchCopier.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:commands="clr-namespace:ArchCopier.Infrastructure.Commands"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        TextElement.FontWeight="Regular"
        TextElement.FontSize="13"
        TextOptions.TextFormattingMode="Ideal"
        TextOptions.TextRenderingMode="Auto"
        Background="{DynamicResource MaterialDesignPaper}"
        FontFamily="{DynamicResource MaterialDesignFont}"
        ResizeMode="CanMinimize"
        WindowStartupLocation="CenterScreen"
        WindowState="Normal"
        Topmost="{Binding IsTopMostMainWindow}"
        Title="{Binding Title}"
        Width="970" Height="590"
        mc:Ignorable="d">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="40" />
            <RowDefinition Height="84" />
            <RowDefinition Height="4*" />
            <RowDefinition Height="42" />
            <RowDefinition Height="35" />
            <RowDefinition Height="0.01*" />
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="0.05*" />
            <ColumnDefinition Width="2.6*" />
            <ColumnDefinition Width="2.6*" />
            <ColumnDefinition Width="0.05*" />
        </Grid.ColumnDefinitions>
        <Menu Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="3" VerticalAlignment="Center" Padding="3"
              materialDesign:MenuAssist.TopLevelMenuItemHeight="25">
            <MenuItem Header="Файл">
                <MenuItem Header="Открыть сборку в Компасе" Command="{Binding OpenAssemblyCommand}" />
                <MenuItem Header="Построить дерево" Command="{Binding BuildTreeCommand}" />
                <Separator />
                
                <MenuItem Header="Выход" Command="{Binding CloseApplicationCommand}" />
            </MenuItem>
            <MenuItem Header="Компас">
                <MenuItem Header="Проверить Компас" Command="{Binding CheckKompasInstallCommand}" />
                <MenuItem Header="Запустить Компас" Command="{Binding StartKompasCommand}" />
                <MenuItem Header="Перезапустить Компас" Command="{Binding RestartKompasCommand}" />
                <MenuItem Header="Закрыть Компас" Command="{Binding CloseKompasCommand}" />
                <MenuItem Header="Перевести в видимый режим" Command="{Binding MakeKompasVisibleCommand}" />
                <MenuItem Header="Перевести в невидимый режим" Command="{Binding MakeKompasInvisibleCommand}" />
                <MenuItem Header="Молчаливый режим с ответом 'Да'" Command="{Binding MuteKompasModeWithYesCommand}" />
                <MenuItem Header="Молчаливый режим с ответом 'Нет'" Command="{Binding MuteKompasModeWithNoCommand}" />
                
            </MenuItem>
            
            <MenuItem Header="Настройки">
                <MenuItem Header="Внешний вид" Command="{Binding GetHelpCommand}" />
                <MenuItem Header="Указать рабочую папку с архивом А" Command="{Binding ChooseDirectoryWithArchACommand}" />
                <MenuItem Header="Указать рабочую папку с архивом В" Command="{Binding ChooseDirectoryWithArchBCommand}" />
                <MenuItem Header="Указать рабочую папку с проектами А" Command="{Binding ChooseDirectoryWithProjectsACommand}" />
                <MenuItem Header="Указать рабочую папку с проектами В" Command="{Binding ChooseDirectoryWithProjectsACommand}" />
                <MenuItem Header="Выбрать файл настроек" Command="{Binding ChooseSettingsFileCommand}" />
                <MenuItem Header="Сохранить настройки" Command="{Binding WriteSettingsFileCommand}" />
                <MenuItem Header="Перечитать файл настроек" Command="{Binding RereadSettingsFileCommand}" />
                
            </MenuItem>
            
            <MenuItem Header="Помощь">
                <MenuItem Header="Справка" Command="{Binding GetHelpCommand}" />
                <MenuItem Header="О программе">
                    <MenuItem.Command>
                        <commands:ManageAboutProgramCommand />
                    </MenuItem.Command>
                </MenuItem>
            </MenuItem>
               
        </Menu>
        <StackPanel Grid.Row="1" Grid.Column="1" Grid.ColumnSpan="2" Orientation="Vertical">
            <DockPanel Margin="0 0 2 10">
                <TextBlock DockPanel.Dock="Left" Text="Выбрать головную сборку проекта: "
                           Height="25" VerticalAlignment="Bottom"
                           Padding="4" />
                <TextBlock DockPanel.Dock="Left"
                           Text="{Binding FullNameOfCurrentAssembly}"
                           Width="450" Height="30" VerticalAlignment="Bottom"
                           Padding="4 8 4 0"
                           Background="DimGray">
                    <TextBlock.ContextMenu>
                        <ContextMenu>
                            <MenuItem Header="Копировать" Command="{Binding CopyShortFileNameCommand}" />
                        </ContextMenu>
                    </TextBlock.ContextMenu>
                </TextBlock>
                <Button
                    DockPanel.Dock="Left"
                    Width="150"
                    VerticalAlignment="Center"
                    HorizontalAlignment="Left"
                    Margin="5 0 0 0 "
                    Content="Выбрать сборку"
                    Command="{Binding ChooseAssemblyCommand}"
                    IsEnabled="True"
                    Style="{StaticResource MaterialDesignPaperButton}"
                    ToolTip="Выбрать головную сборку проекта" />
            </DockPanel>
            <DockPanel Margin="0 0 2 10">
                <TextBlock DockPanel.Dock="Left" Text="Папка назначения в архиве: "
                           Height="25" VerticalAlignment="Bottom"
                           Padding="4 4 45 4" />
                <TextBlock DockPanel.Dock="Left"
                           Text="{Binding ArhDirectory}"
                           Width="450" Height="30" VerticalAlignment="Bottom"
                           Padding="4 8 4 0"
                           Background="DimGray">
                    <TextBlock.ContextMenu>
                        <ContextMenu>
                            <MenuItem Header="Копировать" Command="{Binding CopyShortFileNameCommand}" />
                        </ContextMenu>
                    </TextBlock.ContextMenu>
                </TextBlock>
                <Button
                    DockPanel.Dock="Left"
                    Width="150"
                    VerticalAlignment="Center"
                    HorizontalAlignment="Left"
                    Margin="5 0 0 0 "
                    Content="Выбрать архив"
                    Command="{Binding OpenArchDirectoryCommand}"
                    IsEnabled="True"
                    Style="{StaticResource MaterialDesignPaperButton}"
                    ToolTip="Выбрать папку назначения архива" />
            </DockPanel>
        </StackPanel>
        <DockPanel Grid.Column="1" Grid.Row="2" Grid.ColumnSpan="2" Margin="0 0 2 10" VerticalAlignment="Top" HorizontalAlignment="Left" Height="340" Width="470">
            <DockPanel LastChildFill="True" Margin="0 0 0 0">
                <GroupBox DockPanel.Dock="Top" Width="auto" Height="auto" Header="Список компонентов сборки">
                    <ListBox ItemsSource="{Binding ListComponents}" DisplayMemberPath="ShortFileName"
                             SelectedItem="{Binding SelectedComponent, Mode=OneWay}">
                    </ListBox>
                </GroupBox>
            </DockPanel>
        </DockPanel>

        <DockPanel Grid.Column="1" Grid.Row="4" Grid.ColumnSpan="2" LastChildFill="True" Margin="0 0 2 0" Height="26"
                   VerticalAlignment="Center" materialDesign:ColorZoneAssist.Background="{DynamicResource Accent800}">

            <TextBlock Text="{Binding Status}" VerticalAlignment="Top" />
        </DockPanel>
        <StackPanel Grid.Column="2" Grid.Row="2" Margin="0 0 2 0" VerticalAlignment="Bottom">
            <DockPanel Margin="10 0 2 0" Height="40">
                <Button Width="217"
                        Margin="5 0 0 0"
                        Command="{Binding StartKompasCommand}"
                        Content="{Binding KompasButtonName}"
                        IsEnabled="{Binding IsKompasButtonEnabled}"
                        Style="{StaticResource MaterialDesignPaperButton}"
                        FontSize="13"
                        ToolTip="Запустить или проверить Компас" />
                <Button Width="217"
                        Command="{Binding ReadAssemblyCommand}"
                        Content="{Binding RunButtonName}"
                        IsEnabled="{Binding IsWorkButtonsEnabled}"
                        Style="{StaticResource MaterialDesignPaperButton}"
                        ToolTip="Обработать чертежи" />
            </DockPanel>
            <DockPanel Margin="10 0 2 0" Height="40"
                       VerticalAlignment="Bottom">
                <Button Width="217"
                        Margin="5 0 0 0"
                        HorizontalAlignment="Left"
                        Command="{Binding ReadActiveAssemblyCommand}"
                        Content="Прочитать акт. сборку"
                        IsEnabled="{Binding IsButtonOfActiveDocumentEnabled}"
                        Style="{StaticResource MaterialDesignPaperButton}"
                        ToolTip="Прочитать активную открытую сборку в Компасе" />
                <Button Width="217"
                        Command="{Binding CopyFilesOfComponentsToArchDirectoryCommand}"
                        Content="Выгрузить в архив"
                        Style="{StaticResource MaterialDesignPaperButton}"
                        IsEnabled="{Binding IsArchUploadButtonsEnabled}"
                        ToolTip="Копирование файлов компонентов в выбранную папку архива" />
            </DockPanel>
        </StackPanel>
        <DockPanel Grid.Row="3" Grid.Column="1" Grid.ColumnSpan="2" Margin="10 0 2 0" Height="46" LastChildFill="True">
            <Button DockPanel.Dock="Right" Width="40" Height="32"
                    Content="{materialDesign:PackIcon Stop}"
                    Command="{Binding InterruptProcessCommand}"
                    Style="{StaticResource MaterialDesignPaperButton}"
                    Margin="2 1 2 4 "
                    Padding="5"
                    Visibility="{Binding ProgressBarVisibility}"
                    ToolTip="Icon" />
            <Button DockPanel.Dock="Right" Width="40" Height="32"
                    Content="{materialDesign:PackIcon Pause}"
                    Command="{Binding PauseResumeProcessCommand}"
                    Margin="2 1 2 4"
                    Padding="5"
                    Style="{StaticResource MaterialDesignPaperButton}"
                    Visibility="{Binding ProgressBarVisibility}"
                    ToolTip="Icon" />
            <ProgressBar
                DockPanel.Dock="Left"
                Margin="5"
                Padding="4"
                Value="{Binding Progress}"
                materialDesign:TransitionAssist.DisableTransitions="True"
                Visibility="{Binding ProgressBarVisibility}" />
        </DockPanel>
    </Grid>
</Window>